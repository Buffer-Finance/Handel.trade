if(console.log("Loading service worker..."),console.log("Before firebase load..."),importScripts("https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"),importScripts("https://www.gstatic.com/firebasejs/8.10.1/firebase-messaging.js"),console.log("After firebase load..."),"undefined"!=typeof firebase&&indexedDB){console.log("Firebase loaded..."),firebase.initializeApp({apiKey:"AIzaSyCCAD16awvFkw-miZ4ZTh-mHg91lBAcYVw",authDomain:"handelnetwork.firebaseapp.com",databaseURL:"https://handelnetwork-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"handelnetwork",storageBucket:"handelnetwork.appspot.com",messagingSenderId:"1082881637112",appId:"1:1082881637112:web:38af36852e46aba86a190d",measurementId:"G-7XR78M1SB5"});const o=firebase.messaging();console.log({messaging:o}),o.onBackgroundMessage((o=>{console.log("Received background message ",o),indexedDB.open("handel-network-db",1).onsuccess=function(e){var t=e.target.result,a=t.transaction("configs","readonly").objectStore("configs");a.get("is_popup_on").onsuccess=function(e){var i=o.data.topic;console.log("Notification is for topic:",i),console.log("Is popup on: ",e.target.result),e.target.result&&e.target.result.value&&o.data&&(a=t.transaction("configs","readonly").objectStore("configs"),console.log("Notification Again is for topic:",i),a.get(i).onsuccess=function(e){if(console.log("Notification is on:: ",i,e.target.result.value),e.target.result.value){const e=o.data.title,t={body:o.data.body,icon:"Logo.svg",tag:o.data.title,data:o.data};self.registration.showNotification(e,t)}})}}})),self.addEventListener("notificationclick",(o=>{console.log("Notification click: ",o),o.notification.data&&(console.log("On notification click: ",o.notification.data),o.notification.close(),o.waitUntil(clients.matchAll({type:"window"}).then((e=>{for(const t of e)if(t.url==o.notification.data.openPath&&"focus"in t)return t.focus();return clients.openWindow(o.notification.data.openPath)}))))}))}else console.error("Firebase not loaded");